<!DOCTYPE html> 
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Select City</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="../styles/city.css" />
  <script src="../scripts/auth.js"></script>
</head>
<body>

  <div class="container" role="main" aria-label="City selection container">
    <div class="header">
      <!-- Hamburger icon at top right -->
      <button class="hamburger" aria-label="Open menu">&#9776;</button>
      <h2 class="title">Select City</h2>
    </div>

    <div class="search-box">
      <input type="text" id="city-search" placeholder="Select city to book your ride" aria-label="Search city" />
      <span class="search-icon">&#128269;</span>
    </div>

    <div class="grid" id="city-grid" role="list">
      <!-- Cities list unchanged ... -->
      <div class="city-card" role="listitem" style="background-image: url('../images/t.png');"><span>TIRUPATI</span></div>
      <div class="city-card" role="listitem" style="background-image: url('../images/ag.png');"><span>AGRA</span></div>
      <div class="city-card" role="listitem" style="background-image: url('../images/vij.png');"><span>VIJAYAWADA</span></div>
      <div class="city-card" role="listitem" style="background-image: url('../images/Vizag.png');"><span>VIZAG</span></div>
      <div class="city-card" role="listitem" style="background-image: url('../images/gu.png');"><span>GUNTUR</span></div>
      <div class="city-card" role="listitem" style="background-image: url('../images/del.png');"><span>DELHI</span></div>
      <div class="city-card" role="listitem" style="background-image: url('../images/mum.png');"><span>MUMBAI</span></div>
      <div class="city-card" role="listitem" style="background-image: url('../images/kol.png');"><span>KOLKATA</span></div>
      <div class="city-card" role="listitem" style="background-image: url('../images/ch.png');"><span>CHENNAI</span></div>
      <div class="city-card" role="listitem" style="background-image: url('../images/ban.png');"><span>BANGALORE</span></div>
      <div class="city-card" role="listitem" style="background-image: url('../images/jai.png');"><span>JAIPUR</span></div>
      <div class="city-card" role="listitem" style="background-image: url('../images/hyd.png');"><span>HYDERABAD</span></div>
      <div class="city-card" role="listitem" style="background-image: url('../images/pune.png');"><span>PUNE</span></div>
      <div class="city-card" role="listitem" style="background-image: url('../images/lucknow.png');"><span>LUCKNOW</span></div>
      <div class="city-card" role="listitem" style="background-image: url('../images/ahmedabad.png');"><span>AHMEDABAD</span></div>
      <div class="city-card" role="listitem" style="background-image: url('../images/kanpur.png');"><span>KANPUR</span></div>
      <div class="city-card" role="listitem" style="background-image: url('../images/nagpur.png');"><span>NAGPUR</span></div>
      <div class="city-card" role="listitem" style="background-image: url('../images/thane.png');"><span>THANE</span></div>
      <div class="city-card" role="listitem" style="background-image: url('../images/bhopal.png');"><span>BHOPAL</span></div>
      <div class="city-card" role="listitem" style="background-image: url('../images/visakhapatnam.png');"><span>VISAKHAPATNAM</span></div>
      <div class="city-card" role="listitem" style="background-image: url('../images/patna.png');"><span>PATNA</span></div>
      <div class="city-card" role="listitem" style="background-image: url('../images/bhubaneswar.png');"><span>BHUBANESWAR</span></div>
      <div class="city-card" role="listitem" style="background-image: url('../images/coimbatore.png');"><span>COIMBATORE</span></div>
      <div class="city-card" role="listitem" style="background-image: url('../images/indore.png');"><span>INDORE</span></div>
    </div>
  </div>

  <script>
    // Check authentication and auto-redirect based on role
    window.addEventListener('DOMContentLoaded', () => {
      autoRedirectBasedOnRole();
    });

    // Search filter code
    const searchInput = document.getElementById('city-search');
    const cityCards = document.querySelectorAll('.city-card');

    searchInput.addEventListener('input', (event) => {
      const query = event.target.value.toLowerCase();
      cityCards.forEach(card => {
        const cityName = card.textContent.toLowerCase();
        card.style.display = cityName.includes(query) ? 'flex' : 'none';
      });
    });

    // City card click event to save selection and redirect
    cityCards.forEach(card => {
      card.addEventListener('click', () => {
        const cityName = card.textContent.trim();
        const bgImageStyle = card.style.backgroundImage;
        const imageUrlMatch = bgImageStyle.match(/url\(["']?(.*?)["']?\)/);
        const imageUrl = imageUrlMatch ? imageUrlMatch[1] : '';

        localStorage.setItem('selectedCity', JSON.stringify({ name: cityName, image: imageUrl }));
        window.location.href = 'search.html';
      });
    });

    // Hamburger button click: open hamburger.html
    document.querySelector('.hamburger').addEventListener('click', function() {
      window.location.href = 'hamburger.html';
    });
  </script>

</body>
</html>